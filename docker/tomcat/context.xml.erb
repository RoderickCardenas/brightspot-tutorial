<?xml version='1.0' encoding='utf-8'?>
<Context>

    <Resources cacheMaxSize="102400" cacheObjectMaxSize="512" />

    <!-- Default set of monitored resources -->
    <WatchedResource>WEB-INF/web.xml</WatchedResource>

    <Environment name="DOCKER" type="java.lang.Boolean" value="true" />
    <Environment name="PRODUCTION" type="java.lang.Boolean" value="false" />
    <Environment name="SECRET" type="java.lang.String" value="brightspot" />

    <!-- CMS Settings -->
    <Environment name="cms/tool/isAutoCreateUser" type="java.lang.Boolean" value="true" />

    <!-- Storage Item Settings -->
    <Environment name="dari/defaultStorage" type="java.lang.String" value="local" />

    <Environment name="dari/storage/local/class" type="java.lang.String" value="com.psddev.dari.util.LocalStorageItem" />
    <Environment name="dari/storage/local/rootPath" type="java.lang.String" value="/servers/tomcat/storage" />
    <Environment name="dari/storage/local/baseUrl" type="java.lang.String" value="http://${external.host}/storage" />
    <Environment name="dari/storage/local/secureBaseUrl" type="java.lang.String" value="https://${external.host}/storage" />
    <Environment name="dari/storage/local/originBaseUrl" type="java.lang.String" value="http://${apache.host}/storage" />

    <!-- Image Editor Settings -->
    <Environment name="dari/defaultImageEditor" type="java.lang.String" value="dims" />

    <Environment name="dari/imageEditor/dims/class" type="java.lang.String" value="com.psddev.dari.util.DimsImageEditor" />
    <Environment name="dari/imageEditor/dims/baseUrl" type="java.lang.String" value="//${external.host}/dims4/default" />
    <Environment name="dari/imageEditor/dims/privateBaseUrl" type="java.lang.String" value="http://${apache.host}/dims4/default" />
    <Environment name="dari/imageEditor/dims/sharedSecret" type="java.lang.String" value="${dims.secret}" />
    <Environment name="dari/imageEditor/dims/quality" type="java.lang.Integer" value="90" />
    <Environment name="dari/disableIntermediateImageSizes" type="java.lang.Boolean" value="true" />

    <!-- Database Settings -->
    <Environment name="dari/defaultDatabase" type="java.lang.String" value="brightspot" />

    <Environment name="dari/database/brightspot/class" type="java.lang.String" value="com.psddev.dari.db.AggregateDatabase" />
    <Environment name="dari/database/brightspot/defaultDelegate" type="java.lang.String" value="sql" />
    <Environment name="dari/database/brightspot/delegate/sql/class" type="java.lang.String" value="com.psddev.dari.mysql.MySQLDatabase" />
    <Environment name="dari/database/brightspot/delegate/sql/enableReplicationCache" type="java.lang.Boolean" value="true" />
    <Environment name="dari/database/brightspot/delegate/sql/indexSpatial" override="false" type="java.lang.Boolean" value="false" />

    <%- if @data['brightspot']['extra_dari_db'] != nil %>
    <!-- Extra Dari Database Resource Links, see server.xml for connection settings. -->
    <% db_name = @data['brightspot']['extra_dari_db'] %>
    <Environment name="dari/database/<%= db_name %>/class" type="java.lang.String" value="com.psddev.dari.mysql.MySQLDatabase" />
    <ResourceLink name="dari/database/<%= db_name %>/dataSource" global="dari/database/<%= db_name %>/dataSource" type="javax.sql.DataSource" />
    <%- end -%>

    <!-- Database Resource Links, see server.xml for connection settings. -->
    <ResourceLink name="dari/database/brightspot/delegate/sql/dataSource" global="dari/database/brightspot/delegate/sql/dataSource" type="javax.sql.DataSource"/>
    <ResourceLink name="dari/database/brightspot/delegate/sql/readDataSource" global="dari/database/brightspot/delegate/sql/readDataSource" type="javax.sql.DataSource"/>

    <Environment name="dari/database/brightspot/delegate/solr/groups" type="java.lang.String" value="-* +cms.content.searchable" />
    <Environment name="dari/database/brightspot/delegate/solr/class" type="java.lang.String" value="com.psddev.dari.db.SolrDatabase" />
    <Environment name="dari/database/brightspot/delegate/solr/serverUrl" type="java.lang.String" value="${solr.url}" />
    <Environment name="dari/database/brightspot/delegate/solr/version" type="java.lang.String" value="4.8.1" />
    <Environment name="dari/database/brightspot/delegate/solr/autoCommit" type="java.lang.Boolean" value="true" />

    <Environment name="cms/isResourceInStorage" type="java.lang.Boolean" value="true" />

</Context>
